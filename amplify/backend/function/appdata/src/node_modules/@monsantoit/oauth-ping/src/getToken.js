const httpGetToken = require('./httpGetToken')

const getSettings = () => {
    const localDevelopmentSecret = require('./localDevelopmentSecret')
    const {services} = require('@monsantoit/cloud-foundry')
    const value = services['velocity-oauth']
    if (value) {
        return value
    } else if (localDevelopmentSecret) {
        return {
            clientId: 'velocity_admin',
            clientSecret: localDevelopmentSecret
        }
    }
    return undefined
}
const settings = getSettings()

module.exports = settings ? httpGetToken(settings) : () => Promise.resolve()
