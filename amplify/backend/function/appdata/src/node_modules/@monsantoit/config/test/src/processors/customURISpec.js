const customURI = require('../../../src/processors/customURI')

describe('custom uri utils', () => {
    let config = {}

    beforeEach(() => {
        config = {
            'this key': {
                value: 'test://first'
            },
            'another key': {
                'deeply nested': {
                    'three levels': 'test://second'
                }
            }
        }
    })

    describe('findValuesWithprefix', () => {
        it('finds values with a custom prefix, returning a list of values without the prefix', () => {
            customURI.findValuesWithPrefix(config, 'test://').should.eql(['first', 'second'])
        })
    })

    describe('replaceValuesWithPrefix', () => {
        it('replaces values with a custom prefix, returning the updated config.', () => {
            customURI
                .replaceValuesWithPrefix(
                    config,
                    {first: 'replaced-first', second: 'replaced-second'},
                    'test://'
                )
                .should.eql({
                    'this key': {
                        value: 'replaced-first'
                    },
                    'another key': {
                        'deeply nested': {
                            'three levels': 'replaced-second'
                        }
                    }
                })
        })
    })
})
